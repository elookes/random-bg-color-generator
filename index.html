<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Random Background Color</title>
    <style>
        #listOfColors {
            position: absolute;
            right: 0;
            top: 0;
        }

        .color {
            padding: 10px;
            background: white;
            opacity: 0.6;
            color: #5B5B5B;
        }
    </style>
</head>
<body>
<noscript>You need to enable JavaScript to run this app.</noscript>
<div id="listOfColors"></div>
<script type="text/javascript">

    var limit = 10;
    var length = 6;
    var chars = '0123456789ABCDEF';
    var hex, s, listOfUsedValues;

    try{
        listOfUsedValues = JSON.parse(localStorage.getItem("used")) || [];
    }catch(e){
        listOfUsedValues = [];
    }


    function setValue(v) {
        if (typeof(Storage) !== "undefined") {
            listOfUsedValues.push(v);
            console.log(listOfUsedValues);
            localStorage.setItem("used", JSON.stringify(listOfUsedValues));
        } else {
            used.push(v);
        }
    }


    function generateColor() {
        hex = "#";
        length = 6;
        while (length > 0) {
            hex += chars[(Math.random() * 16) | 0];
            length--
        }
        return hex;
    }

    function getUniqueColor() {
        while (true) {
            rnd = generateColor();
            if (listOfUsedValues.indexOf(rnd) == -1) {
                setValue(rnd);
                return hex;
            }
        }
    }

    function createElement(color) {
        var el = document.createElement("div");
        el.className = 'color';
        el.innerHTML = color;
        return el;
    }

    function addElementToWrapper(el) {
        try {
            document.getElementById('listOfColors').appendChild(el);
        } catch (e) {

        }
    }


    function changeBackground() {
        var color = getUniqueColor();
        document.body.style.backgroundColor = color;
        var el = createElement(color);
        addElementToWrapper(el);
        limit--;
    }


    changeBackground();
    s = setInterval(function () {
        changeBackground();
        if (limit < 1) {
            clearInterval(s);
        }
    }, 1000);
</script>
</body>
</html>
